generator client {
  provider = "prisma-client-js"
  engineType = "library"
  binaryTargets = ["native"]
}

datasource db {
  provider = "postgresql"
}

enum Role {
  USER
  ADMIN
  MODERATOR
}

model User {
  id            String    @id @default(uuid())
  email         String?   @unique
  phone         String?   @unique
  password      String?
  nickname      String?
  tag           String?

  avatarUrl     String?
  provider      String?
  providerId    String?

  role          Role      @default(USER)
  isVerified    Boolean   @default(false)
  
  sessions      Session[]
  
  createdAt     DateTime  @default(now())
  updatedAt     DateTime  @updatedAt

  @@unique([nickname, tag])
}

model Session {
  id           String   @id @default(uuid())
  userId       String
  user         User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  refreshToken String   @unique
  
  userAgent    String?
  ip           String?
  deviceName   String?
  
  expiresAt    DateTime
  createdAt    DateTime @default(now())
  lastActive   DateTime @default(now())
}